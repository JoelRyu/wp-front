<script>
	import { darkMode } from '$lib/stores';

	let selectedTab = $state('my-prayers');
	let isLoggedIn = $state(false); // TODO: Connect to auth system
	let isDarkMode = $derived($darkMode);

	// Mock data - TODO: Replace with API call
	const myPrayers = [
		{
			id: 1,
			title: 'ìƒˆ ì§ì¥ì—ì„œì˜ ì ì‘',
			content: 'ìƒˆë¡œìš´ ì§ì¥ì—ì„œ ì¢‹ì€ ë™ë£Œë“¤ê³¼ í•¨ê»˜ ì„±ì¥í•  ìˆ˜ ìˆë„ë¡...',
			createdAt: '2026-02-01',
			isAnswered: false,
			isPublic: true,
			participants: 12
		},
		{
			id: 2,
			title: 'ë¶€ëª¨ë‹˜ ê±´ê°•',
			content: 'ë¶€ëª¨ë‹˜ì˜ ê±´ê°•ì„ ì§€ì¼œì£¼ì‹œê³ ...',
			createdAt: '2026-01-28',
			isAnswered: false,
			isPublic: true,
			participants: 8
		},
		{
			id: 3,
			title: 'ê°ì‚¬ì˜ ì‘ë‹µ',
			content: 'ì§€ë‚œ ë‹¬ ê¸°ë„í–ˆë˜ ì¼ë“¤ì´ ì˜ í•´ê²°ë˜ì–´ ê°ì‚¬í•©ë‹ˆë‹¤. ì£¼ë‹˜ê»˜ ì˜ê´‘ì„...',
			createdAt: '2026-01-15',
			isAnswered: true,
			isPublic: false,
			participants: 0
		}
	];

	const participatingPrayers = [
		{
			id: 101,
			title: 'ë©´ì ‘ì—ì„œ ì¢‹ì€ ì„±ê³¼ ë‚´ê¸°',
			author: 'ìµëª…',
			createdAt: '2ì‹œê°„ ì „',
			participants: 24,
			joinedAt: '1ì‹œê°„ ì „'
		},
		{
			id: 102,
			title: 'ê°€ì¡±ì˜ ê±´ê°•ê³¼ í‰ì•ˆ',
			author: 'ìµëª…',
			createdAt: '4ì‹œê°„ ì „',
			participants: 38,
			joinedAt: '30ë¶„ ì „'
		},
		{
			id: 103,
			title: 'í”„ë¡œì íŠ¸ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí•˜ê¸°',
			author: 'ìµëª…',
			createdAt: '6ì‹œê°„ ì „',
			participants: 16,
			joinedAt: '2ì‹œê°„ ì „'
		}
	];

	/** @param {number} id */
	function handleEditPrayer(id) {
		console.log('Edit prayer:', id);
		// TODO: Implement edit functionality
	}

	/** @param {number} id */
	function handleDeletePrayer(id) {
		if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
			console.log('Delete prayer:', id);
			// TODO: Implement delete functionality
		}
	}

	/** @param {number} id */
	function handleMarkAnswered(id) {
		console.log('Mark as answered:', id);
		// TODO: Implement mark as answered functionality
	}

	/** @param {number} id */
	function handleLeavePrayer(id) {
		console.log('Leave prayer:', id);
		// TODO: Implement leave prayer functionality
	}
</script>

<div class="space-y-8">
	<!-- Login Required Check -->
	{#if !isLoggedIn}
		<div class="{isDarkMode ? 'bg-blue-900 border-blue-700' : 'bg-blue-50 border-blue-500'} border-l-4 rounded-lg p-8 text-center transition-colors duration-300">
			<h2 class="{isDarkMode ? 'text-blue-100' : 'text-blue-900'} text-2xl font-bold mb-3">ğŸ”’ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
			<p class="{isDarkMode ? 'text-blue-300' : 'text-blue-700'} mb-6">ë‚˜ì˜ ê¸°ë„ ì œëª©ì„ ê´€ë¦¬í•˜ê³ , ê¸°ë„ ëª¨ì„ì— ì°¸ì—¬í•˜ë ¤ë©´ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.</p>
			<button class="px-8 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors">
				ë¡œê·¸ì¸í•˜ê¸°
			</button>
		</div>
	{/if}

	<!-- Header Section -->
	<section class="text-center py-8">
		<h1 class="{isDarkMode ? 'text-gray-100' : 'text-gray-900'} text-4xl md:text-5xl font-bold mb-3">
			ğŸ˜Š My ê¸°ë„
		</h1>
		<p class="{isDarkMode ? 'text-gray-300' : 'text-gray-600'} text-lg">
			ê°œì¸ ê¸°ë„ ì œëª© ê´€ë¦¬ ë° ì°¸ì—¬ ì¤‘ì¸ ê¸°ë„ ëª¨ì„ì„ í™•ì¸í•˜ì„¸ìš”.
		</p>
	</section>

	<!-- Stats Section -->
	<section class="grid md:grid-cols-3 gap-6">
		<div class="{isDarkMode ? 'bg-gray-700 border-blue-500' : 'bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-500'} rounded-2xl shadow-lg p-6 border-l-4 transition-colors duration-300">
			<div class="flex items-center justify-between">
				<div>
					<p class="{isDarkMode ? 'text-gray-400' : 'text-gray-600'} text-sm">ì‘ì„±í•œ ê¸°ë„ ì œëª©</p>
					<p class="{isDarkMode ? 'text-indigo-400' : 'text-indigo-600'} text-3xl font-bold">{myPrayers.length}</p>
				</div>
				<span class="text-4xl">ğŸ™</span>
			</div>
		</div>

		<div class="{isDarkMode ? 'bg-gray-700 border-green-500' : 'bg-gradient-to-br from-green-50 to-emerald-50 border-green-500'} rounded-2xl shadow-lg p-6 border-l-4 transition-colors duration-300">
			<div class="flex items-center justify-between">
				<div>
					<p class="{isDarkMode ? 'text-gray-400' : 'text-gray-600'} text-sm">ì°¸ì—¬ ì¤‘ì¸ ê¸°ë„</p>
					<p class="{isDarkMode ? 'text-green-400' : 'text-green-600'} text-3xl font-bold">{participatingPrayers.length}</p>
				</div>
				<span class="text-4xl">ğŸ‘¥</span>
			</div>
		</div>

		<div class="{isDarkMode ? 'bg-gray-700 border-yellow-500' : 'bg-gradient-to-br from-yellow-50 to-orange-50 border-yellow-500'} rounded-2xl shadow-lg p-6 border-l-4 transition-colors duration-300">
			<div class="flex items-center justify-between">
				<div>
					<p class="{isDarkMode ? 'text-gray-400' : 'text-gray-600'} text-sm">ì‘ë‹µëœ ê¸°ë„</p>
					<p class="{isDarkMode ? 'text-yellow-400' : 'text-orange-600'} text-3xl font-bold">{myPrayers.filter(p => p.isAnswered).length}</p>
				</div>
				<span class="text-4xl">âœ¨</span>
			</div>
		</div>
	</section>

	<!-- Tab Navigation -->
	<section class="{isDarkMode ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-200'} rounded-2xl shadow-lg overflow-hidden border-4 transition-colors duration-300">
		<div class="{isDarkMode ? 'bg-gray-700 border-gray-600' : 'bg-gray-50 border-gray-200'} flex border-b-2">
			<button
				onclick={() => (selectedTab = 'my-prayers')}
				class="flex-1 py-5 px-6 font-bold text-lg transition-all duration-300 {selectedTab === 'my-prayers'
					? 'bg-gradient-to-r from-indigo-500 to-indigo-600 text-white shadow-md border-b-4 border-indigo-700'
					: isDarkMode ? 'text-gray-300 hover:text-indigo-400 hover:bg-gray-600' : 'text-gray-700 hover:text-indigo-600 hover:bg-gray-100'}"
			>
				ğŸ“ ë‚´ ê¸°ë„ ì œëª© <span class="ml-2 px-3 py-1 bg-white bg-opacity-30 rounded-full text-sm font-semibold">{myPrayers.length}</span>
			</button>
			<button
				onclick={() => (selectedTab = 'participating')}
				class="flex-1 py-5 px-6 font-bold text-lg transition-all duration-300 {selectedTab === 'participating'
					? 'bg-gradient-to-r from-green-500 to-green-600 text-white shadow-md border-b-4 border-green-700'
					: isDarkMode ? 'text-gray-300 hover:text-green-400 hover:bg-gray-600' : 'text-gray-700 hover:text-green-600 hover:bg-gray-100'}"
			>
				ğŸ‘¥ ì°¸ì—¬ ì¤‘ì¸ ê¸°ë„ <span class="ml-2 px-3 py-1 bg-white bg-opacity-30 rounded-full text-sm font-semibold">{participatingPrayers.length}</span>
			</button>
		</div>

		<div class="p-8 {selectedTab === 'my-prayers' ? isDarkMode ? 'bg-gray-700' : 'bg-gradient-to-br from-indigo-50 via-white to-blue-50' : isDarkMode ? 'bg-gray-700' : 'bg-gradient-to-br from-green-50 via-white to-emerald-50'} transition-colors duration-300">
			<!-- My Prayers Tab -->
			{#if selectedTab === 'my-prayers'}
				<div class="space-y-4">
					{#each myPrayers as prayer (prayer.id)}
						<div class="{isDarkMode ? 'bg-gray-600 border-indigo-500' : 'bg-gradient-to-br from-white to-blue-50 border-indigo-500'} rounded-xl border-l-4 p-6 hover:shadow-lg transition-all duration-200">
							<div class="flex items-start justify-between mb-4">
								<div class="flex-1">
									<div class="flex items-center space-x-3 mb-2">
										<h3 class="{isDarkMode ? 'text-gray-100' : 'text-gray-900'} text-xl font-bold">
											{prayer.title}
										</h3>
										{#if prayer.isAnswered}
											<span class="{isDarkMode ? 'bg-green-900 text-green-300' : 'bg-green-100 text-green-700'} px-3 py-1 rounded-full text-xs font-bold">
												ì‘ë‹µë¨ âœ¨
											</span>
										{/if}
										{#if prayer.isPublic}
											<span class="{isDarkMode ? 'bg-blue-900 text-blue-300' : 'bg-blue-100 text-blue-700'} px-3 py-1 rounded-full text-xs font-bold">
												ê³µê°œ
											</span>
										{:else}
											<span class="{isDarkMode ? 'bg-gray-500 text-gray-300' : 'bg-gray-100 text-gray-700'} px-3 py-1 rounded-full text-xs font-bold">
												ë¹„ê³µê°œ
											</span>
										{/if}
									</div>
									<p class="{isDarkMode ? 'text-gray-300' : 'text-gray-600'} mb-3">{prayer.content}</p>
									<div class="flex items-center space-x-4 text-sm {isDarkMode ? 'text-gray-400' : 'text-gray-500'}">
										<span>ğŸ“… {prayer.createdAt}</span>
										{#if prayer.participants > 0}
											<span>ğŸ‘¥ {prayer.participants}ëª…ì´ ê¸°ë„ ì¤‘</span>
										{/if}
									</div>
								</div>
								<div class="flex space-x-2 ml-4">
									{#if !prayer.isAnswered}
										<button
										onclick={() => handleMarkAnswered(prayer.id)}
										class="{isDarkMode ? 'bg-green-900 text-green-300 hover:bg-green-800' : 'bg-green-100 text-green-700 hover:bg-green-200'} px-3 py-2 text-sm font-semibold rounded-lg transition-colors"
										title="ì‘ë‹µë¨ìœ¼ë¡œ í‘œì‹œ"
									>
										âœ“ ë‹µë³€
									</button>
								{/if}
								<button
									onclick={() => handleEditPrayer(prayer.id)}
									class="{isDarkMode ? 'bg-blue-900 text-blue-300 hover:bg-blue-800' : 'bg-blue-100 text-blue-700 hover:bg-blue-200'} px-3 py-2 text-sm font-semibold rounded-lg transition-colors"
									title="í¸ì§‘"
								>
									âœï¸ ìˆ˜ì •
								</button>
								<button
									onclick={() => handleDeletePrayer(prayer.id)}
										class="{isDarkMode ? 'bg-red-900 text-red-300 hover:bg-red-800' : 'bg-red-100 text-red-700 hover:bg-red-200'} px-3 py-2 text-sm font-semibold rounded-lg transition-colors"
										title="ì‚­ì œ"
									>
										ğŸ—‘ï¸ ì‚­ì œ
									</button>
								</div>
							</div>
						</div>
					{/each}

					{#if myPrayers.length === 0}
						<div class="text-center py-12">
							<p class="{isDarkMode ? 'text-gray-300' : 'text-gray-600'} text-xl mb-2">ì‘ì„±í•œ ê¸°ë„ ì œëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>
							<p class="{isDarkMode ? 'text-gray-500' : 'text-gray-500'} mb-6">ì²« ë²ˆì§¸ ê¸°ë„ ì œëª©ì„ ì‘ì„±í•´ë³´ì„¸ìš”!</p>
							<a href="/" class="inline-block px-6 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors">
								ê¸°ë„ ì œëª© ì‘ì„±í•˜ê¸°
							</a>
						</div>
					{/if}
				</div>
			{/if}

			<!-- Participating Prayers Tab -->
			{#if selectedTab === 'participating'}
				<div class="space-y-4">
					{#each participatingPrayers as prayer (prayer.id)}
						<div class="{isDarkMode ? 'bg-gray-600 border-green-500' : 'bg-gradient-to-br from-white to-green-50 border-green-500'} rounded-xl border-l-4 p-6 hover:shadow-lg transition-all duration-200">
							<div class="flex items-start justify-between mb-4">
								<div class="flex-1">
									<h3 class="{isDarkMode ? 'text-gray-100' : 'text-gray-900'} text-xl font-bold mb-2">
										{prayer.title}
									</h3>
									<div class="flex items-center space-x-4 text-sm {isDarkMode ? 'text-gray-400' : 'text-gray-600'} mb-3">
										<span>âœï¸ {prayer.author}</span>
										<span>â° {prayer.createdAt}</span>
										<span>ğŸ‘¥ {prayer.participants}ëª… í•¨ê»˜ ê¸°ë„</span>
										<span class="{isDarkMode ? 'text-green-400' : 'text-green-600'} font-semibold">âœ“ ì°¸ì—¬ ì¤‘ ({prayer.joinedAt})</span>
									</div>
								</div>
								<button
									onclick={() => handleLeavePrayer(prayer.id)}
									class="{isDarkMode ? 'bg-red-900 text-red-300 hover:bg-red-800' : 'bg-red-100 text-red-700 hover:bg-red-200'} px-4 py-2 font-bold rounded-lg transition-colors whitespace-nowrap ml-4"
									title="ê¸°ë„ ëª¨ì„ì—ì„œ ë‚˜ê°€ê¸°"
								>
									âœ• ë‚˜ê°€ê¸°
								</button>
							</div>
						</div>
					{/each}

					{#if participatingPrayers.length === 0}
						<div class="text-center py-12">
							<p class="{isDarkMode ? 'text-gray-300' : 'text-gray-600'} text-xl mb-2">ì°¸ì—¬ ì¤‘ì¸ ê¸°ë„ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
							<p class="{isDarkMode ? 'text-gray-500' : 'text-gray-500'} mb-6">Wallì—ì„œ ê¸°ë„ ì œëª©ì„ ì°¾ì•„ í•¨ê»˜ ê¸°ë„í•´ë³´ì„¸ìš”!</p>
							<a href="/wall" class="inline-block px-6 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors">
								Wall ë³´ê¸°
							</a>
						</div>
					{/if}
				</div>
			{/if}
		</div>
	</section>

	<!-- Quick Stats -->
	<section class="bg-gradient-to-r from-indigo-600 to-blue-600 rounded-2xl shadow-lg p-8 text-white">
		<h2 class="text-2xl font-bold mb-4">ğŸ’ª ê¸°ë„ì˜ í˜</h2>
		<div class="grid md:grid-cols-3 gap-6">
			<div>
				<p class="text-indigo-100 mb-2">ì´ ê¸°ë„ ì‹œê°„</p>
				<p class="text-3xl font-bold">42ì‹œê°„</p>
			</div>
			<div>
				<p class="text-indigo-100 mb-2">ì¶•ë³µí•œ ê¸°ë„ë“¤</p>
				<p class="text-3xl font-bold">127ê°œ</p>
			</div>
			<div>
				<p class="text-indigo-100 mb-2">ì—°ì† ê¸°ë„ì¼</p>
				<p class="text-3xl font-bold">21ì¼</p>
			</div>
		</div>
	</section>
</div>
